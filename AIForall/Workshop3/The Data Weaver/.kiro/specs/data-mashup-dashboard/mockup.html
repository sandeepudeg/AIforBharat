<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather & Pollen Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-controls {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .location-selectors {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .location-selector {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            min-width: 120px;
        }

        .location-selector option {
            background: #667eea;
            color: white;
        }

        .location-separator {
            color: white;
            font-weight: bold;
        }

        .last-updated {
            font-size: 12px;
            opacity: 0.9;
        }

        .metric-selector {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .metric-btn {
            padding: 8px 15px;
            border: 2px solid white;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .metric-btn.active {
            background: white;
            color: #667eea;
        }

        .metric-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .time-range-filters {
            background: #f8f9fa;
            padding: 20px 30px;
            display: flex;
            gap: 10px;
            border-bottom: 1px solid #e0e0e0;
            justify-content: center;
        }

        .time-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .time-btn.active {
            background: #667eea;
            color: white;
        }

        .time-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .info-panels {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .panel {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .panel h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .weather-item, .pollen-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .weather-item:last-child, .pollen-item:last-child {
            border-bottom: none;
        }

        .weather-item label, .pollen-item label {
            font-weight: 600;
            color: #333;
        }

        .weather-item value, .pollen-item value {
            color: #667eea;
            font-weight: 700;
            font-size: 16px;
        }

        .pollen-level {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .pollen-level.high {
            background: #ff6b6b;
            color: white;
        }

        .pollen-level.moderate {
            background: #ffd93d;
            color: #333;
        }

        .pollen-level.low {
            background: #6bcf7f;
            color: white;
        }

        .alert {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 15px;
            border-radius: 4px;
            color: #856404;
            font-size: 14px;
        }

        .charts-section {
            padding: 30px;
            background: white;
        }

        .chart-container {
            position: relative;
            height: 450px;
            margin-bottom: 50px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            page-break-inside: avoid;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #667eea;
        }

        .correlation-section {
            padding: 40px 30px;
            background: white;
            border-top: 3px solid #667eea;
        }

        .correlation-container {
            background: white;
            padding: 0;
            border-radius: 0;
            box-shadow: none;
        }

        .correlation-container h2 {
            color: #667eea;
            margin-bottom: 30px;
            font-size: 22px;
            font-weight: 700;
            padding-bottom: 15px;
            border-bottom: 2px solid #667eea;
        }

        .correlation-item {
            padding: 20px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #f0f4ff 0%, #f8faff 100%);
            border-left: 5px solid #667eea;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }

        .correlation-item strong {
            color: #667eea;
            display: block;
            margin-bottom: 10px;
            font-size: 15px;
            font-weight: 700;
        }

        .correlation-value {
            font-size: 14px;
            color: #555;
            line-height: 1.7;
        }

        .correlation-strength {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .correlation-strength.strong {
            background: #667eea;
            color: white;
        }

        .correlation-strength.moderate {
            background: #ffd93d;
            color: #333;
        }

        .correlation-strength.weak {
            background: #e0e0e0;
            color: #333;
        }

        .footer {
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-export {
            background: #667eea;
            color: white;
        }

        .btn-export:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-screenshot {
            background: #764ba2;
            color: white;
        }

        .btn-screenshot:hover {
            background: #653a8a;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.3);
        }

        .btn-refresh {
            background: #6bcf7f;
            color: white;
        }

        .btn-refresh:hover {
            background: #5ab86e;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(107, 207, 127, 0.3);
        }

        .date-range {
            font-size: 12px;
            color: #999;
            margin-bottom: 20px;
            font-style: italic;
        }

        .parameter-selector {
            background: white;
            padding: 18px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .parameter-selector h4 {
            font-size: 14px;
            color: #667eea;
            margin-bottom: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .parameter-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            cursor: pointer;
            width: 16px;
            height: 16px;
        }

        .checkbox-item label {
            cursor: pointer;
            font-size: 13px;
            color: #555;
        }

        .comparative-feedback {
            background: linear-gradient(135deg, #e8f4f8 0%, #f0f9fc 100%);
            border-left: 5px solid #0288d1;
            padding: 18px;
            margin-top: 25px;
            border-radius: 6px;
            font-size: 14px;
            color: #01579b;
            line-height: 1.7;
            box-shadow: 0 2px 8px rgba(2, 136, 209, 0.1);
        }

        .comparative-feedback strong {
            color: #0288d1;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            .info-panels {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 15px;
            }

            .header-controls {
                flex-direction: column;
                width: 100%;
            }

            .location-selector {
                width: 100%;
            }

            .time-range-filters {
                flex-wrap: wrap;
            }

            .footer {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üå§Ô∏è Weather & Pollen Dashboard</h1>
            <div class="header-controls">
                <div class="location-selectors">
                    <select class="location-selector" id="countrySelect">
                        <option value="">Select Country</option>
                        <option value="usa">United States</option>
                        <option value="india">India</option>
                        <option value="uk">United Kingdom</option>
                        <option value="canada">Canada</option>
                    </select>
                    <span class="location-separator">‚Üí</span>
                    <select class="location-selector" id="stateSelect">
                        <option value="">Select State</option>
                    </select>
                    <span class="location-separator">‚Üí</span>
                    <select class="location-selector" id="districtSelect">
                        <option value="">Select District</option>
                    </select>
                </div>
                <div class="metric-selector">
                    <span style="font-size: 12px;">Units:</span>
                    <button class="metric-btn active" data-metric="imperial">¬∞F / mph</button>
                    <button class="metric-btn" data-metric="metric">¬∞C / km/h</button>
                </div>
                <div class="last-updated">Last Updated: 2:45 PM</div>
            </div>
        </div>

        <!-- Time Range Filters -->
        <div class="time-range-filters">
            <button class="time-btn active">üìÖ Weekly</button>
            <button class="time-btn">üìä Monthly</button>
            <button class="time-btn">üìà Half-Yearly</button>
            <button class="time-btn">üìä Yearly</button>
        </div>

        <!-- Info Panels -->
        <div class="info-panels">
            <!-- Weather Panel -->
            <div class="panel">
                <h2>üå°Ô∏è Current Weather</h2>
                <div class="weather-item">
                    <label>Temperature:</label>
                    <value>72¬∞F</value>
                </div>
                <div class="weather-item">
                    <label>Humidity:</label>
                    <value>65%</value>
                </div>
                <div class="weather-item">
                    <label>Wind Speed:</label>
                    <value>12 mph</value>
                </div>
                <div class="weather-item">
                    <label>Atmospheric Pressure:</label>
                    <value>1013 mb</value>
                </div>
                <div class="weather-item">
                    <label>Precipitation:</label>
                    <value>0 mm</value>
                </div>
                <div class="weather-item">
                    <label>UV Index:</label>
                    <value>6 (High)</value>
                </div>
                <div class="weather-item">
                    <label>Conditions:</label>
                    <value>Partly Cloudy</value>
                </div>
            </div>

            <!-- Pollen Panel -->
            <div class="panel">
                <h2>üåæ Pollen Levels by Type</h2>
                <div class="pollen-item">
                    <label>Grass Pollen:</label>
                    <value>850 <span class="pollen-level high">HIGH</span></value>
                </div>
                <div class="pollen-item">
                    <label>Tree Pollen:</label>
                    <value>450 <span class="pollen-level moderate">MODERATE</span></value>
                </div>
                <div class="pollen-item">
                    <label>Weed Pollen:</label>
                    <value>150 <span class="pollen-level low">LOW</span></value>
                </div>
                <div class="pollen-item">
                    <label>Ragweed Pollen:</label>
                    <value>200 <span class="pollen-level low">LOW</span></value>
                </div>
                <div class="pollen-item">
                    <label>Mold Spores:</label>
                    <value>320 <span class="pollen-level moderate">MODERATE</span></value>
                </div>
                <div class="alert">
                    ‚ö†Ô∏è <strong>High Pollen Alert:</strong> Grass pollen levels are elevated today. Consider staying indoors if you have allergies.
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-section">
            <!-- Weather Parameters Trend Chart -->
            <div class="chart-container">
                <div class="chart-title">üìà Weather Parameters Trend (Weekly View)</div>
                <div class="date-range">Jan 1 - Jan 7, 2024</div>
                
                <div class="parameter-selector">
                    <h4>Select Parameters to Display:</h4>
                    <div class="parameter-checkboxes">
                        <div class="checkbox-item">
                            <input type="checkbox" id="tempCheck" checked>
                            <label for="tempCheck">üå°Ô∏è Temperature</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="humidityCheck">
                            <label for="humidityCheck">üíß Humidity</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="windCheck">
                            <label for="windCheck">üí® Wind Speed</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="pressureCheck">
                            <label for="pressureCheck">üîΩ Pressure</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="precipCheck">
                            <label for="precipCheck">üåßÔ∏è Precipitation</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="uvCheck">
                            <label for="uvCheck">‚òÄÔ∏è UV Index</label>
                        </div>
                    </div>
                </div>

                <canvas id="temperatureChart"></canvas>

                <div class="comparative-feedback" id="comparativeFeedback">
                    <strong>üìä Comparative Analysis:</strong> Currently showing Temperature trend. Select additional parameters to see how they interact with pollen levels.
                </div>
            </div>

            <!-- Pollen Levels Chart -->
            <div class="chart-container">
                <div class="chart-title">üìä Pollen Levels by Type (Weekly View)</div>
                <div class="date-range">Jan 1 - Jan 7, 2024</div>
                
                <div class="parameter-selector">
                    <h4>Select Pollen Types to Display:</h4>
                    <div class="parameter-checkboxes">
                        <div class="checkbox-item">
                            <input type="checkbox" id="grassPollenCheck" checked>
                            <label for="grassPollenCheck">üåæ Grass Pollen</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="treePollenCheck" checked>
                            <label for="treePollenCheck">üå≥ Tree Pollen</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="weedPollenCheck" checked>
                            <label for="weedPollenCheck">üå± Weed Pollen</label>
                        </div>
                    </div>
                </div>

                <canvas id="pollenChart"></canvas>
            </div>

            <!-- Combined Trend Chart -->
            <div class="chart-container">
                <div class="chart-title">üîó Weather vs Pollen Correlation (Weekly View)</div>
                <div class="date-range">Jan 1 - Jan 7, 2024</div>
                
                <div class="parameter-selector">
                    <h4>Select Weather Parameters:</h4>
                    <div class="parameter-checkboxes">
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrTempCheck" checked>
                            <label for="corrTempCheck">üå°Ô∏è Temperature</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrHumidityCheck">
                            <label for="corrHumidityCheck">üíß Humidity</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrWindCheck">
                            <label for="corrWindCheck">üí® Wind Speed</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrPressureCheck">
                            <label for="corrPressureCheck">üîΩ Pressure</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrPrecipCheck">
                            <label for="corrPrecipCheck">üåßÔ∏è Precipitation</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrUVCheck">
                            <label for="corrUVCheck">‚òÄÔ∏è UV Index</label>
                        </div>
                    </div>
                </div>

                <div class="parameter-selector">
                    <h4>Select Pollen Types:</h4>
                    <div class="parameter-checkboxes">
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrGrassCheck" checked>
                            <label for="corrGrassCheck">üåæ Grass Pollen</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrTreeCheck">
                            <label for="corrTreeCheck">üå≥ Tree Pollen</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="corrWeedCheck">
                            <label for="corrWeedCheck">üå± Weed Pollen</label>
                        </div>
                    </div>
                </div>

                <canvas id="correlationChart"></canvas>

                <div class="comparative-feedback" id="correlationFeedback">
                    <strong>üîó Correlation Analysis:</strong> Showing Temperature vs Grass Pollen. Select additional parameters to analyze their combined correlation patterns.
                </div>
            </div>
        </div>

        <!-- Correlation Section -->
        <div class="correlation-section">
            <div class="correlation-container">
                <h2>üîç Correlation Insights - Weather Factors vs Pollen Levels</h2>
                
                <div class="correlation-item">
                    <strong>Wind Speed ‚Üî Pollen Levels</strong>
                    <span class="correlation-strength strong">+0.78 (Strong Positive)</span>
                    <div class="correlation-value">
                        Higher wind speeds increase pollen dispersion in the air. On windy days, expect higher pollen counts and more severe allergy symptoms.
                    </div>
                </div>

                <div class="correlation-item">
                    <strong>Temperature ‚Üî Pollen Levels</strong>
                    <span class="correlation-strength moderate">+0.45 (Moderate Positive)</span>
                    <div class="correlation-value">
                        Warmer days tend to have higher pollen counts. Plants release more pollen in warm weather, so spring and summer typically have elevated levels.
                    </div>
                </div>

                <div class="correlation-item">
                    <strong>Humidity ‚Üî Pollen Levels</strong>
                    <span class="correlation-strength moderate">-0.62 (Moderate Negative)</span>
                    <div class="correlation-value">
                        High humidity reduces pollen in the air. Rainy or humid days typically have lower pollen counts, making them better for outdoor activities if you have allergies.
                    </div>
                </div>

                <div class="correlation-item">
                    <strong>Atmospheric Pressure ‚Üî Pollen Levels</strong>
                    <span class="correlation-strength moderate">+0.55 (Moderate Positive)</span>
                    <div class="correlation-value">
                        Low atmospheric pressure is associated with higher pollen levels. Low pressure systems trigger plants to release more pollen and reduce pollen settling.
                    </div>
                </div>

                <div class="correlation-item">
                    <strong>Precipitation ‚Üî Pollen Levels</strong>
                    <span class="correlation-strength strong">-0.81 (Strong Negative)</span>
                    <div class="correlation-value">
                        Rain significantly reduces airborne pollen by washing it out of the air. Rainy days are ideal for allergy sufferers to spend time outdoors.
                    </div>
                </div>

                <div class="correlation-item">
                    <strong>UV Index ‚Üî Pollen Levels</strong>
                    <span class="correlation-strength moderate">+0.52 (Moderate Positive)</span>
                    <div class="correlation-value">
                        High UV index (sunny days) correlates with higher pollen counts. Clear, sunny weather promotes pollen release and dispersal.
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <button class="btn btn-export">üì• Export as JSON</button>
            <button class="btn btn-screenshot">üì∏ Screenshot</button>
            <button class="btn btn-refresh">üîÑ Refresh Data</button>
        </div>
    </div>

    <script>
        // Location hierarchy data
        const locationData = {
            usa: {
                name: 'United States',
                states: {
                    ny: { name: 'New York', districts: ['Manhattan', 'Brooklyn', 'Queens', 'Bronx', 'Staten Island'] },
                    ca: { name: 'California', districts: ['Los Angeles', 'San Francisco', 'San Diego', 'Sacramento'] },
                    tx: { name: 'Texas', districts: ['Houston', 'Dallas', 'Austin', 'San Antonio'] },
                    fl: { name: 'Florida', districts: ['Miami', 'Orlando', 'Tampa', 'Jacksonville'] }
                }
            },
            india: {
                name: 'India',
                states: {
                    mh: { name: 'Maharashtra', districts: ['Mumbai', 'Pune', 'Nagpur', 'Aurangabad'] },
                    dl: { name: 'Delhi', districts: ['New Delhi', 'East Delhi', 'West Delhi', 'North Delhi'] },
                    ka: { name: 'Karnataka', districts: ['Bangalore', 'Mysore', 'Mangalore', 'Belgaum'] },
                    tn: { name: 'Tamil Nadu', districts: ['Chennai', 'Coimbatore', 'Madurai', 'Salem'] }
                }
            },
            uk: {
                name: 'United Kingdom',
                states: {
                    en: { name: 'England', districts: ['London', 'Manchester', 'Birmingham', 'Leeds'] },
                    sc: { name: 'Scotland', districts: ['Edinburgh', 'Glasgow', 'Aberdeen', 'Dundee'] },
                    wa: { name: 'Wales', districts: ['Cardiff', 'Swansea', 'Newport', 'Wrexham'] }
                }
            },
            canada: {
                name: 'Canada',
                states: {
                    on: { name: 'Ontario', districts: ['Toronto', 'Ottawa', 'Hamilton', 'London'] },
                    bc: { name: 'British Columbia', districts: ['Vancouver', 'Victoria', 'Surrey', 'Burnaby'] },
                    qc: { name: 'Quebec', districts: ['Montreal', 'Quebec City', 'Laval', 'Gatineau'] }
                }
            }
        };

        // Country selector change
        document.getElementById('countrySelect').addEventListener('change', function() {
            const countryCode = this.value;
            const stateSelect = document.getElementById('stateSelect');
            const districtSelect = document.getElementById('districtSelect');
            
            stateSelect.innerHTML = '<option value="">Select State</option>';
            districtSelect.innerHTML = '<option value="">Select District</option>';
            
            if (countryCode && locationData[countryCode]) {
                const states = locationData[countryCode].states;
                for (const [code, state] of Object.entries(states)) {
                    const option = document.createElement('option');
                    option.value = code;
                    option.textContent = state.name;
                    stateSelect.appendChild(option);
                }
            }
        });

        // State selector change
        document.getElementById('stateSelect').addEventListener('change', function() {
            const countryCode = document.getElementById('countrySelect').value;
            const stateCode = this.value;
            const districtSelect = document.getElementById('districtSelect');
            
            districtSelect.innerHTML = '<option value="">Select District</option>';
            
            if (countryCode && stateCode && locationData[countryCode]) {
                const districts = locationData[countryCode].states[stateCode].districts;
                districts.forEach(district => {
                    const option = document.createElement('option');
                    option.value = district;
                    option.textContent = district;
                    districtSelect.appendChild(option);
                });
            }
        });

        // District selector change
        document.getElementById('districtSelect').addEventListener('change', function() {
            if (this.value) {
                const country = document.getElementById('countrySelect').options[document.getElementById('countrySelect').selectedIndex].text;
                const state = document.getElementById('stateSelect').options[document.getElementById('stateSelect').selectedIndex].text;
                const district = this.value;
                alert(`Fetching data for ${district}, ${state}, ${country}`);
                // In real implementation, this would fetch new data
            }
        });

        // Metric system selector
        let currentMetric = 'imperial';
        document.querySelectorAll('.metric-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.metric-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentMetric = this.dataset.metric;
                
                // Convert temperature
                const tempValue = document.querySelector('.weather-item:nth-child(1) value');
                if (currentMetric === 'metric') {
                    tempValue.textContent = '22¬∞C';
                } else {
                    tempValue.textContent = '72¬∞F';
                }
                
                // Convert wind speed
                const windValue = document.querySelector('.weather-item:nth-child(3) value');
                if (currentMetric === 'metric') {
                    windValue.textContent = '19 km/h';
                } else {
                    windValue.textContent = '12 mph';
                }
                
                alert(`Switched to ${currentMetric === 'metric' ? 'Metric (¬∞C, km/h)' : 'Imperial (¬∞F, mph)'} system`);
            });
        });

        // Parameter selection and comparative feedback
        const parameterData = {
            temp: { label: 'üå°Ô∏è Temperature', data: [65, 68, 72, 75, 73, 70, 68], color: '#FF4444' },
            humidity: { label: 'üíß Humidity', data: [55, 60, 65, 62, 68, 70, 72], color: '#0099FF' },
            wind: { label: 'üí® Wind Speed', data: [8, 10, 12, 15, 14, 11, 9], color: '#00CC44' },
            pressure: { label: 'üîΩ Pressure', data: [1010, 1012, 1013, 1011, 1009, 1008, 1010], color: '#FF9900' },
            precip: { label: 'üåßÔ∏è Precipitation', data: [0, 0, 0, 2, 5, 1, 0], color: '#9933FF' },
            uv: { label: '‚òÄÔ∏è UV Index', data: [3, 4, 6, 7, 6, 5, 4], color: '#FFDD00' }
        };

        const parameterFeedback = {
            temp: "Temperature increases pollen release from plants.",
            humidity: "High humidity reduces airborne pollen.",
            wind: "Wind speed significantly increases pollen dispersion.",
            pressure: "Low pressure triggers higher pollen release.",
            precip: "Precipitation washes pollen out of the air.",
            uv: "High UV index correlates with increased pollen levels."
        };

        function updateChart() {
            const selectedParams = [];
            const selectedData = [];
            const yAxisMap = {
                temp: 'y',
                humidity: 'y1',
                wind: 'y2',
                pressure: 'y3',
                precip: 'y4',
                uv: 'y5'
            };
            
            let visibleAxes = new Set(['y']); // Temperature axis always visible
            
            // Only check weather parameter checkboxes
            document.querySelectorAll('#tempCheck, #humidityCheck, #windCheck, #pressureCheck, #precipCheck, #uvCheck').forEach(cb => {
                if (cb.checked) {
                    const paramKey = cb.id.replace('Check', '');
                    selectedParams.push(parameterData[paramKey].label);
                    const yAxis = yAxisMap[paramKey];
                    visibleAxes.add(yAxis);
                    
                    selectedData.push({
                        label: parameterData[paramKey].label,
                        data: parameterData[paramKey].data,
                        borderColor: parameterData[paramKey].color,
                        backgroundColor: parameterData[paramKey].color + '20',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: false,
                        yAxisID: yAxis
                    });
                }
            });

            // Update chart with selected parameters
            if (temperatureChart) {
                temperatureChart.data.datasets = selectedData;
                
                // Update Y-axis visibility
                Object.keys(yAxisMap).forEach(key => {
                    const yAxis = yAxisMap[key];
                    if (temperatureChart.options.scales[yAxis]) {
                        temperatureChart.options.scales[yAxis].display = visibleAxes.has(yAxis);
                    }
                });
                
                temperatureChart.update();
            }

            // Update feedback
            const feedback = document.getElementById('comparativeFeedback');
            if (selectedParams.length === 0) {
                feedback.innerHTML = '<strong>üìä Comparative Analysis:</strong> Select parameters to see how they interact with pollen levels.';
            } else if (selectedParams.length === 1) {
                const paramKey = Array.from(document.querySelectorAll('#tempCheck, #humidityCheck, #windCheck, #pressureCheck, #precipCheck, #uvCheck')).find(cb => cb.checked).id.replace('Check', '');
                feedback.innerHTML = `<strong>üìä Single Parameter Analysis:</strong> ${selectedParams[0]} is displayed. ${parameterFeedback[paramKey]}`;
            } else {
                feedback.innerHTML = `<strong>üìä Multi-Parameter Analysis:</strong> Showing ${selectedParams.join(', ')}. These parameters work together to influence pollen levels. High wind combined with low humidity and high temperature creates ideal conditions for maximum pollen dispersion.`;
            }
        }

        // Only attach updateChart to weather parameter checkboxes (not pollen or correlation checkboxes)
        document.querySelectorAll('#tempCheck, #humidityCheck, #windCheck, #pressureCheck, #precipCheck, #uvCheck').forEach(checkbox => {
            checkbox.addEventListener('change', updateChart);
        });

        let temperatureChart; // Will be initialized below

        // Temperature Chart - Initialize with Temperature selected by default
        const temperatureCtx = document.getElementById('temperatureChart').getContext('2d');
        temperatureChart = new Chart(temperatureCtx, {
            type: 'line',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                datasets: [{
                    label: 'üå°Ô∏è Temperature',
                    data: [65, 68, 72, 75, 73, 70, 68],
                    borderColor: '#ff6b6b',
                    backgroundColor: 'rgba(255, 107, 107, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 6,
                    pointBackgroundColor: '#ff6b6b',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointHoverRadius: 8,
                    yAxisID: 'y'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false
                },
                plugins: {
                    legend: {
                        display: true,
                        labels: { font: { size: 12 } }
                    }
                },
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: { display: true, text: 'Temperature (¬∞F)' },
                        min: 60,
                        max: 80
                    },
                    y1: {
                        type: 'linear',
                        display: false,
                        position: 'right',
                        title: { display: true, text: 'Humidity (%)' },
                        min: 0,
                        max: 100,
                        grid: { drawOnChartArea: false }
                    },
                    y2: {
                        type: 'linear',
                        display: false,
                        position: 'right',
                        title: { display: true, text: 'Wind (mph)' },
                        min: 0,
                        max: 20,
                        grid: { drawOnChartArea: false }
                    },
                    y3: {
                        type: 'linear',
                        display: false,
                        position: 'right',
                        title: { display: true, text: 'Pressure (mb)' },
                        min: 1000,
                        max: 1020,
                        grid: { drawOnChartArea: false }
                    },
                    y4: {
                        type: 'linear',
                        display: false,
                        position: 'right',
                        title: { display: true, text: 'Precipitation (mm)' },
                        min: 0,
                        max: 10,
                        grid: { drawOnChartArea: false }
                    },
                    y5: {
                        type: 'linear',
                        display: false,
                        position: 'right',
                        title: { display: true, text: 'UV Index' },
                        min: 0,
                        max: 10,
                        grid: { drawOnChartArea: false }
                    }
                }
            }
        });

        // Pollen Chart - Using bar chart for better visibility
        const pollenCtx = document.getElementById('pollenChart').getContext('2d');
        let pollenChart = new Chart(pollenCtx, {
            type: 'bar',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                datasets: [
                    {
                        label: 'üåæ Grass Pollen',
                        data: [600, 650, 850, 800, 750, 500, 450],
                        backgroundColor: '#00CC44',
                        borderColor: '#00AA33',
                        borderWidth: 2
                    },
                    {
                        label: 'üå≥ Tree Pollen',
                        data: [300, 350, 450, 400, 380, 250, 200],
                        backgroundColor: '#FF9900',
                        borderColor: '#DD7700',
                        borderWidth: 2
                    },
                    {
                        label: 'üå± Weed Pollen',
                        data: [100, 120, 150, 140, 130, 80, 60],
                        backgroundColor: '#9933FF',
                        borderColor: '#7722DD',
                        borderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        labels: { font: { size: 12 } }
                    }
                },
                scales: {
                    x: {
                        stacked: false
                    },
                    y: {
                        stacked: false,
                        title: { display: true, text: 'Pollen Count' }
                    }
                }
            }
        });

        // Correlation Chart
        const correlationCtx = document.getElementById('correlationChart').getContext('2d');
        let correlationChart = new Chart(correlationCtx, {
            type: 'line',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                datasets: [
                    {
                        label: 'üå°Ô∏è Temperature (¬∞F)',
                        data: [65, 68, 72, 75, 73, 70, 68],
                        borderColor: '#FF4444',
                        backgroundColor: 'rgba(255, 68, 68, 0.1)',
                        borderWidth: 2,
                        yAxisID: 'y',
                        tension: 0.4
                    },
                    {
                        label: 'üåæ Grass Pollen',
                        data: [1000, 1120, 1450, 1340, 1260, 830, 710],
                        borderColor: '#00CC44',
                        backgroundColor: 'rgba(0, 204, 68, 0.1)',
                        borderWidth: 2,
                        yAxisID: 'y1',
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false
                },
                plugins: {
                    legend: {
                        display: true,
                        labels: { font: { size: 12 } }
                    }
                },
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: { display: true, text: 'Temperature (¬∞F)' },
                        min: 60,
                        max: 80
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: { display: true, text: 'Grass Pollen' },
                        min: 500,
                        max: 1500,
                        grid: { drawOnChartArea: false }
                    },
                    y2: { type: 'linear', display: false, position: 'right', title: { display: true, text: 'Humidity (%)' }, min: 0, max: 100, grid: { drawOnChartArea: false } },
                    y3: { type: 'linear', display: false, position: 'right', title: { display: true, text: 'Wind (mph)' }, min: 0, max: 20, grid: { drawOnChartArea: false } },
                    y4: { type: 'linear', display: false, position: 'right', title: { display: true, text: 'Pressure (mb)' }, min: 1000, max: 1020, grid: { drawOnChartArea: false } },
                    y5: { type: 'linear', display: false, position: 'right', title: { display: true, text: 'Precipitation (mm)' }, min: 0, max: 10, grid: { drawOnChartArea: false } },
                    y6: { type: 'linear', display: false, position: 'right', title: { display: true, text: 'UV Index' }, min: 0, max: 10, grid: { drawOnChartArea: false } },
                    y7: { type: 'linear', display: false, position: 'right', title: { display: true, text: 'Tree Pollen' }, min: 400, max: 900, grid: { drawOnChartArea: false } },
                    y8: { type: 'linear', display: false, position: 'right', title: { display: true, text: 'Weed Pollen' }, min: 200, max: 500, grid: { drawOnChartArea: false } }
                }
            }
        });

        // Correlation chart parameter selection
        const correlationWeatherData = {
            temp: { label: 'üå°Ô∏è Temperature', data: [65, 68, 72, 75, 73, 70, 68], color: '#FF4444', yAxis: 'y' },
            humidity: { label: 'üíß Humidity', data: [55, 60, 65, 62, 68, 70, 72], color: '#0099FF', yAxis: 'y2' },
            wind: { label: 'üí® Wind Speed', data: [8, 10, 12, 15, 14, 11, 9], color: '#00CC44', yAxis: 'y3' },
            pressure: { label: 'üîΩ Pressure', data: [1010, 1012, 1013, 1011, 1009, 1008, 1010], color: '#FF9900', yAxis: 'y4' },
            precip: { label: 'üåßÔ∏è Precipitation', data: [0, 0, 0, 2, 5, 1, 0], color: '#9933FF', yAxis: 'y5' },
            uv: { label: '‚òÄÔ∏è UV Index', data: [3, 4, 6, 7, 6, 5, 4], color: '#FFDD00', yAxis: 'y6' }
        };

        const correlationPollenData = {
            grass: { label: 'üåæ Grass Pollen', data: [1000, 1120, 1450, 1340, 1260, 830, 710], color: '#00CC44', yAxis: 'y1' },
            tree: { label: 'üå≥ Tree Pollen', data: [600, 650, 850, 800, 750, 500, 450], color: '#FF9900', yAxis: 'y7' },
            weed: { label: 'üå± Weed Pollen', data: [300, 350, 450, 400, 380, 250, 200], color: '#9933FF', yAxis: 'y8' }
        };

        // Pollen chart parameter selection
        const pollenTypeData = {
            grass: { label: 'üåæ Grass Pollen', data: [600, 650, 850, 800, 750, 500, 450], backgroundColor: '#00CC44', borderColor: '#00AA33' },
            tree: { label: 'üå≥ Tree Pollen', data: [300, 350, 450, 400, 380, 250, 200], backgroundColor: '#FF9900', borderColor: '#DD7700' },
            weed: { label: 'üå± Weed Pollen', data: [100, 120, 150, 140, 130, 80, 60], backgroundColor: '#9933FF', borderColor: '#7722DD' }
        };

        function updatePollenChart() {
            const datasets = [];
            
            document.querySelectorAll('#grassPollenCheck, #treePollenCheck, #weedPollenCheck').forEach(cb => {
                if (cb.checked) {
                    const pollenType = cb.id.replace('PollenCheck', '').toLowerCase();
                    if (pollenTypeData[pollenType]) {
                        const data = pollenTypeData[pollenType];
                        datasets.push({
                            label: data.label,
                            data: data.data,
                            backgroundColor: data.backgroundColor,
                            borderColor: data.borderColor,
                            borderWidth: 2
                        });
                    }
                }
            });

            if (pollenChart) {
                pollenChart.data.datasets = datasets;
                pollenChart.update();
            }
        }

        document.querySelectorAll('#grassPollenCheck, #treePollenCheck, #weedPollenCheck').forEach(checkbox => {
            checkbox.addEventListener('change', updatePollenChart);
        });

        // Correlation chart parameter selection with proper logic
        function updateCorrelationChart() {
            const datasets = [];
            const visibleAxes = new Set();
            
            // Get selected weather parameters
            const selectedWeatherParams = [];
            document.querySelectorAll('#corrTempCheck, #corrHumidityCheck, #corrWindCheck, #corrPressureCheck, #corrPrecipCheck, #corrUVCheck').forEach(cb => {
                if (cb.checked) {
                    const paramKey = cb.id.replace('corr', '').replace('Check', '').toLowerCase();
                    selectedWeatherParams.push(paramKey);
                    if (correlationWeatherData[paramKey]) {
                        const data = correlationWeatherData[paramKey];
                        visibleAxes.add(data.yAxis);
                        datasets.push({
                            label: data.label,
                            data: data.data,
                            borderColor: data.color,
                            backgroundColor: data.color + '20',
                            borderWidth: 2,
                            tension: 0.4,
                            yAxisID: data.yAxis
                        });
                    }
                }
            });

            // Get selected pollen types
            const selectedPollenTypes = [];
            document.querySelectorAll('#corrGrassCheck, #corrTreeCheck, #corrWeedCheck').forEach(cb => {
                if (cb.checked) {
                    const pollenKey = cb.id.replace('corr', '').replace('Check', '').toLowerCase();
                    selectedPollenTypes.push(pollenKey);
                    if (correlationPollenData[pollenKey]) {
                        const data = correlationPollenData[pollenKey];
                        visibleAxes.add(data.yAxis);
                        datasets.push({
                            label: data.label,
                            data: data.data,
                            borderColor: data.color,
                            backgroundColor: data.color + '20',
                            borderWidth: 2,
                            tension: 0.4,
                            yAxisID: data.yAxis
                        });
                    }
                }
            });

            // Update chart
            if (correlationChart) {
                correlationChart.data.datasets = datasets;
                
                // Update Y-axis visibility
                ['y', 'y1', 'y2', 'y3', 'y4', 'y5', 'y6', 'y7', 'y8'].forEach(axis => {
                    if (correlationChart.options.scales[axis]) {
                        correlationChart.options.scales[axis].display = visibleAxes.has(axis);
                    }
                });
                
                correlationChart.update();
            }

            // Update feedback
            const feedback = document.getElementById('correlationFeedback');
            if (selectedWeatherParams.length === 0 && selectedPollenTypes.length === 0) {
                feedback.innerHTML = '<strong>üîó Correlation Analysis:</strong> Select weather parameters and pollen types to analyze their correlations.';
            } else {
                const weatherLabels = selectedWeatherParams.map(p => correlationWeatherData[p]?.label).filter(Boolean);
                const pollenLabels = selectedPollenTypes.map(p => correlationPollenData[p]?.label).filter(Boolean);
                const allLabels = [...weatherLabels, ...pollenLabels];
                feedback.innerHTML = `<strong>üîó Correlation Analysis:</strong> Analyzing ${allLabels.join(', ')}. The chart shows how these parameters correlate with each other over time.`;
            }
        }

        // Attach event listeners to all correlation checkboxes
        document.querySelectorAll('#corrTempCheck, #corrHumidityCheck, #corrWindCheck, #corrPressureCheck, #corrPrecipCheck, #corrUVCheck, #corrGrassCheck, #corrTreeCheck, #corrWeedCheck').forEach(checkbox => {
            checkbox.addEventListener('change', updateCorrelationChart);
        });

        // Time range filter buttons
        document.querySelectorAll('.time-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                // In real implementation, this would fetch new data and update charts
                alert('Switching to ' + this.textContent + ' view');
            });
        });
    </script>
</body>
</html>
